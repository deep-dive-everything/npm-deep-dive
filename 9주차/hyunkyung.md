# 5장

## 5.1 트랜스파일을 도와주는 도구, 바벨

- 바벨: 최신 자바스크립트 코드를 구형 브라우저와 호환되는 코드로 변환하는 데 사용되는 대표적인 트랜스파일러

### 5.1.1 바벨의 필요성

#### 5.1.1.1 트랜스파일러의 필요성

- ESMAScript 표준의 제정은 바벨이 필요해진 계기
- ES6의 새로운 기능과 문법들이 구형 브라우저에서 지원되지 않아 이를 사용하면서도 실행 가능한 코드로 변환할 필요가 있었음

#### 5.1.1.3 바벨의 특징

- 플러그인 시스템
  - 필요한 기능만 선택적으로 트랜스파일할 수 있게 동작하여 유연성과 확장성 제공
- ES6을 넘어 광범위한 자바스크립트 문법 지원
  - JSX, 타입스크립트 등등
- 여러 플러그인을 쉽게 설정할 수 있는 프리셋 제공
  - 여러 플러그인을 묶어둔 프리셋 기능을 제공함으로써 특정 환경이나 목표에 맞게 미리 구성된 설정 사용할 수 있게 함
- 활발한 커뮤니티의 지원

### 5.1.2 바벨의 동작 방식

#### 5.1.2.1 추상 구문 트리

- 추상구문트리: 소스코드의 구조를 트리 형태로 표현한 자료구조
- 구성요소
  - 노드: 트리의 각 요소를 나타내며, 주로 변수나 함수 선언문 등 코드의 구문 요소를 의미하는 기본 단위
  - 자식 노드: 특정 노드의 하위 요소로 해당 구문 요소의 세부 항목을 포함(ex: 함수선언문의 경우, 함수명이나 파라미터, 함수 블록의 내용)
  - 최상위 노드: 트리의 최상위노드로 전체 프로그램이나 코드 블록

#### 5.1.2.2 바벨이 코드를 변환하는 과정

1. 파싱: 입력된 소스코드를 읽어 들여 이를 해석해 추상 구문 트리로 변환
2. 변환: 바벨의 핵심 작업인 코드를 변환하는 작업 수행
3. 출력: 변환 단계에서 수정된 추상 구문트리를 다시 코드로 변환하여 최종적으로 출력

### 5.1.3 바벨 사용해보기

- 바벨 config 파일을 통해 어떤 프리셋, plugin, env를 사용할지 정할 수 있음
- targets 필드
  - 코드가 실행될 환경을 지정해 그 환경에 맞는 자바스크립트 구문으로 변환(browser, node, esmodule 버전)
- 번들러와 함께 사용하기
  - 바벨을 단독으로 사용하게 되면 생기는 문제들
    - 브라우저의 경우 require() 함수와 module.exports를 지원하지 않으므로 cjs로 변환했을 시 문제가 생길 수 있음
    - 최적화 문제: 코드 스플리팅을 지원하지 않고 자바스크립트가 아닌 다른 파일의 경우 관리하기 어려움
  - 이런 이유로 실제 프로젝트에서는 웹팩이나 롤업 같은 모듈 번들러에서 바벨을 함께 사용

## 5.2 폴리필을 도와주는 도구 core-js

- 트랜스파일만으로는 ES6의 모든 명세를 변환하기 어려움
- 특히 Promise 같은 객체는 완벽하게 대체하기 어려워 Promise의 모든 인터페이스와 메서드 구현을 포함한 동일한 객체를 전역에 새롭게 정의하여 사용해야 함
- 이처럼 트랜스파일만으로는 해결되지 않는 기능들을 지원하기 위해 동일한 이름으로 낮은 ES 문법만 사용가능한 구형 브라우저 환경에서도 작동하도록 전역에 생성되는 메서드나 객체를 폴리필이라 함

### 5.2.1 core-js란 무엇인가

- 폴리필을 제공하는 대표적인 자바스크립트 라이브러리
- 바벨은 core-js를 프리셋과 플러그인에서 폴리필 기능으로 포함해서 설정할 수 있게 도움
- 아직 표준으로 채택되지 않은 제안 기능까지 지원
- core-js의 특징
  - 폴리필 제공: 최신 ECMAScript 기능에 대한 폴리필 제공
  - 모듈화: 필요한 기능만 개별적으로 임포트해서 사용 가능
  - 제안 단계의 기능 지원

### 5.2.2 바벨과 core-js

#### 5.2.2.2 런타임에 core-js 폴리필을 로드하기

- 큰 번들 크기: 바벨의 헬퍼함수가 필요한 모든 파일에 추가되어 중복 코드가 생기고 번들 크기가 커짐
- 전역 네임스페이스 오염: 내장 기능들이 전역 스코프에 추가되어 전역 네임스페이스 오염
